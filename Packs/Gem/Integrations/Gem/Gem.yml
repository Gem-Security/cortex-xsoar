category: Cloud Services
sectionOrder:
- Connect
- Collect
commonfields:
  id: Gem
  version: -1
defaultmapperin: Gem Mapper
defaultclassifier: Gem Classifier
configuration:
- display: Incident type
  name: incidentType
  type: 13
  defaultvalue: Gem Alert
  section: Connect
  required: false
- display: API Endpoint
  defaultvalue: "https://app.gem.security/api"
  additionalinfo: "The API endpoint to use for connection (US or EU)"
  name: api_endpoint
  type: 15
  section: Connect
  required: true
  options:
  - "https://app.gem.security/api"
  - "https://eu-west-1.app.gem.security/api"
- display: Service Account ID
  additionalinfo: The Service Account ID to use for connection
  name: client_id
  type: 0
  section: Connect
  required: true
- display: Service Account Secret
  additionalinfo: The Service Account Secret to use for connection
  name: client_secret
  type: 4
  section: Connect
  required: true
- display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  defaultvalue: 30 days
  name: first_fetch
  required: false
  type: 0
- display: Use system proxy settings
  name: proxy
  type: 8
  section: Connect
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  section: Collect
  required: false
- display: Maximum number of alerts per fetch
  defaultvalue: 10
  name: max_fetch
  type: 0
  section: Collect
  required: false
description: "Use Gem alerts as a trigger for Cortex XSOARâ€™s custom playbooks, to automate response to specific TTPs."
display: Gem
name: Gem
script:
  commands:
  - name: gem-list-threats
    description: List all threats detected in Gem.
    arguments:
    - name: limit
      description: The number of alert to fetch.
      required: false
      defaultValue: "50"
    - name: time_start
      description: "The start time of the threats to return in ISO format. Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: time_end
      description: "The end time of the threats to return in ISO format. Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: ordering
      description: The ordering of the items.
      required: false
      defaultValue: "-timeframe_start"
      auto: PREDEFINED
      predefined:
      - "-timeframe_start"
      - "timeframe_state"
      - "-mitre_technique"
      - "mitre_technique"
      - "-severity"
      - "severity"
      - "-assignee"
      - "assignee"
      - "-is_resolved"
      - "is_resolved"
    - name: status
      description: The status of the threats to return.
      required: false
      isArray: true
      auto: PREDEFINED
      predefined:
      - open
      - resolved
      - in_progress
    - name: ttp_id
      description: The TTP ID of the threats to return.
      required: false
    - name: title
      description: The title of the threats to return.
      required: false
    - name: severity
      description: The severity of the threats to return.
      required: false
      isArray: true
      auto: PREDEFINED
      predefined:
      - low
      - medium
      - high
    - name: cloud_provider
      description: The provider of the threats to return.
      required: false
      isArray: true
      auto: PREDEFINED
      predefined:
      - aws
      - azure
      - gcp
      - okta
      - huawei
    - name: entity_type
      description: The entity type of the threats to return.
      required: false
    outputs:
    - contextPath: Gem.ThreatsList.accounts.account_status
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.accounts.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.accounts.display_name
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.accounts.hierarchy_path.id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.accounts.hierarchy_path.name
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.accounts.id
      description: ""
      type: Number
    - contextPath: Gem.ThreatsList.accounts.identifier
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.accounts.organization_name
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alert_source
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.accounts.account_status
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.accounts.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.accounts.display_name
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.accounts.id
      description: ""
      type: Number
    - contextPath: Gem.ThreatsList.alerts.accounts.identifier
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.accounts.organization_name
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.alert_source
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.datetime
      description: ""
      type: Date
    - contextPath: Gem.ThreatsList.alerts.description
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.entities.activity_by_provider
      description: ""
      type: Unknown
    - contextPath: Gem.ThreatsList.alerts.entities.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.entities.id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.entities.is_main_entity
      description: ""
      type: Boolean
    - contextPath: Gem.ThreatsList.alerts.entities.is_secondary_entity
      description: ""
      type: Boolean
    - contextPath: Gem.ThreatsList.alerts.entities.resource_id
      description: ""
      type: Unknown
    - contextPath: Gem.ThreatsList.alerts.entities.type
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.main_alert_id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.mitre_techniques.id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.mitre_techniques.technique_name
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.organization_id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.severity
      description: ""
      type: Number
    - contextPath: Gem.ThreatsList.alerts.severity_text
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.status
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.title
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.alerts.ttp_id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.assignees
      description: ""
      type: Unknown
    - contextPath: Gem.ThreatsList.category
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.datetime
      description: ""
      type: Date
    - contextPath: Gem.ThreatsList.description
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.entities.activity_by_provider
      description: ""
      type: Unknown
    - contextPath: Gem.ThreatsList.entities.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.entities.id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.entities.is_main_entity
      description: ""
      type: Boolean
    - contextPath: Gem.ThreatsList.entities.is_secondary_entity
      description: ""
      type: Boolean
    - contextPath: Gem.ThreatsList.entities.resource_id
      description: ""
      type: Unknown
    - contextPath: Gem.ThreatsList.entities.type
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.main_alert_id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.mitre_techniques.id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.mitre_techniques.technique_name
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.organization_id
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.severity_text
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.status
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.title
      description: ""
      type: String
    - contextPath: Gem.ThreatsList.ttp_id
      description: ""
      type: String

  - name: gem-get-threat-details
    description: Get details about a specific threat.
    arguments:
    - name: threat_id
      description: The ID of the threat to get details for.
      required: true
    outputs:
    - contextPath: Gem.Threat.accounts.account_status
      description: ""
      type: String
    - contextPath: Gem.Threat.accounts.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.Threat.accounts.display_name
      description: ""
      type: String
    - contextPath: Gem.Threat.accounts.hierarchy_path.id
      description: ""
      type: String
    - contextPath: Gem.Threat.accounts.hierarchy_path.name
      description: ""
      type: String
    - contextPath: Gem.Threat.accounts.id
      description: ""
      type: Number
    - contextPath: Gem.Threat.accounts.identifier
      description: ""
      type: String
    - contextPath: Gem.Threat.accounts.organization_name
      description: ""
      type: String
    - contextPath: Gem.Threat.alert_source
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.accounts.account_status
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.accounts.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.accounts.display_name
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.accounts.id
      description: ""
      type: Number
    - contextPath: Gem.Threat.alerts.accounts.identifier
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.accounts.organization_name
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.alert_source
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.datetime
      description: ""
      type: Date
    - contextPath: Gem.Threat.alerts.description
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.entities.activity_by_provider
      description: ""
      type: Unknown
    - contextPath: Gem.Threat.alerts.entities.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.entities.id
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.entities.is_main_entity
      description: ""
      type: Boolean
    - contextPath: Gem.Threat.alerts.entities.is_secondary_entity
      description: ""
      type: Boolean
    - contextPath: Gem.Threat.alerts.entities.resource_id
      description: ""
      type: Unknown
    - contextPath: Gem.Threat.alerts.entities.type
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.id
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.main_alert_id
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.mitre_techniques.id
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.mitre_techniques.technique_name
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.organization_id
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.severity
      description: ""
      type: Number
    - contextPath: Gem.Threat.alerts.severity_text
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.status
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.title
      description: ""
      type: String
    - contextPath: Gem.Threat.alerts.ttp_id
      description: ""
      type: String
    - contextPath: Gem.Threat.assignees
      description: ""
      type: Unknown
    - contextPath: Gem.Threat.category
      description: ""
      type: String
    - contextPath: Gem.Threat.datetime
      description: ""
      type: Date
    - contextPath: Gem.Threat.description
      description: ""
      type: String
    - contextPath: Gem.Threat.entities.activity_by_provider
      description: ""
      type: Unknown
    - contextPath: Gem.Threat.entities.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.Threat.entities.id
      description: ""
      type: String
    - contextPath: Gem.Threat.entities.is_main_entity
      description: ""
      type: Boolean
    - contextPath: Gem.Threat.entities.is_secondary_entity
      description: ""
      type: Boolean
    - contextPath: Gem.Threat.entities.resource_id
      description: ""
      type: Unknown
    - contextPath: Gem.Threat.entities.type
      description: ""
      type: String
    - contextPath: Gem.Threat.id
      description: ""
      type: String
    - contextPath: Gem.Threat.main_alert_id
      description: ""
      type: String
    - contextPath: Gem.Threat.mitre_techniques.id
      description: ""
      type: String
    - contextPath: Gem.Threat.mitre_techniques.technique_name
      description: ""
      type: String
    - contextPath: Gem.Threat.organization_id
      description: ""
      type: String
    - contextPath: Gem.Threat.severity_text
      description: ""
      type: String
    - contextPath: Gem.Threat.status
      description: ""
      type: String
    - contextPath: Gem.Threat.title
      description: ""
      type: String
    - contextPath: Gem.Threat.ttp_id
      description: ""
      type: String

  - name: gem-get-alert-details
    description: Get details about a specific alert.
    arguments:
    - name: alert_id
      description: The ID of the alert to get details for.
      required: true
    outputs:
    - contextPath: Gem.Alert.alert_context.account_db_id
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.alert_id
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.alert_source
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.alert_source_id
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.alert_source_url
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.created_at
      description: ""
      type: Date
    - contextPath: Gem.Alert.alert_context.description
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.description_template
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.general_cloud_provider
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.mitre_techniques.id
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.mitre_techniques.technique_name
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.resolved
      description: ""
      type: Boolean
    - contextPath: Gem.Alert.alert_context.severity
      description: ""
      type: Number
    - contextPath: Gem.Alert.alert_context.status
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.timeframe_end
      description: ""
      type: Date
    - contextPath: Gem.Alert.alert_context.timeframe_start
      description: ""
      type: Date
    - contextPath: Gem.Alert.alert_context.title
      description: ""
      type: String
    - contextPath: Gem.Alert.alert_context.ttp_id
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.analysis
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.entities.activity_by_provider
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.entities.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.entities.id
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.entities.is_main_entity
      description: ""
      type: Boolean
    - contextPath: Gem.Alert.triage_configuration.entities.is_secondary_entity
      description: ""
      type: Boolean
    - contextPath: Gem.Alert.triage_configuration.entities.resource_id
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.entities.type
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.description
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.end_time
      description: ""
      type: Date
    - contextPath: Gem.Alert.triage_configuration.event_groups.error_code
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.event_name
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.event_type
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.events
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.start_time
      description: ""
      type: Date
    - contextPath: Gem.Alert.triage_configuration.event_groups.time_indicator_text
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.timeline_item_type
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.title
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.event_groups.type
      description: ""
      type: String
    - contextPath: Gem.Alert.triage_configuration.resolve_params.include_data_events
      description: ""
      type: Boolean
    - contextPath: Gem.Alert.triage_configuration.resolve_params.timeframe_lookup_window_hours
      description: ""
      type: Number
    - contextPath: Gem.Alert.triage_configuration.state
      description: ""
      type: String

  - name: gem-list-inventory-resources
    description: List inventory resources in Gem.
    arguments:
    - name: limit
      description: The number of items to return.
      required: false
      defaultValue: "50"
    - name: include_deleted
      description: Include deleted resources in the response.
      required: false
      defaultValue: false
      type: Boolean
    - name: region
      description: The region of the resources to return.
      required: false
    - name: resource_type
      description: The type of the resources to return.
      required: false
    - name: search
      description: The search query to use.
      required: false
    outputs:
    - contextPath: Gem.InventoryItems.account.account_status
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.account.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.account.display_name
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.account.hierarchy_path
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.account.id
      description: ""
      type: Number
    - contextPath: Gem.InventoryItems.account.identifier
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.account.organization_name
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.account.tenant
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.categories
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.created_at
      description: ""
      type: Date
    - contextPath: Gem.InventoryItems.deleted
      description: ""
      type: Boolean
    - contextPath: Gem.InventoryItems.external_url
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.identifiers.name
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.identifiers.value
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.region
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.resource_id
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.resource_type
      description: ""
      type: String
    - contextPath: Gem.InventoryItems.tags
      description: ""
      type: Unknown

  - name: gem-get-resource-details
    description: Get details about a specific resource.
    arguments:
    - name: resource_id
      description: The ID of the resource to get details for.
      required: true
    outputs:
    - contextPath: Gem.InventoryItem.account.account_status
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.account.cloud_provider
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.account.display_name
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.account.hierarchy_path
      description: ""
      type: Unknown
    - contextPath: Gem.InventoryItem.account.id
      description: ""
      type: Number
    - contextPath: Gem.InventoryItem.account.identifier
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.account.organization_name
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.account.tenant
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.categories
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.created_at
      description: ""
      type: Date
    - contextPath: Gem.InventoryItem.deleted
      description: ""
      type: Boolean
    - contextPath: Gem.InventoryItem.external_url
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.identifiers.name
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.identifiers.value
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.region
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.resource_id
      description: ""
      type: String
    - contextPath: Gem.InventoryItem.resource_type
      description: ""
      type: String

  - name: gem-list-ips-by-entity
    description: List all source IP addresses used by an entity in a specific timeframe. The results are sorted by activity volume.
    arguments:
    - name: entity_id
      description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg."
      required: true
    - name: entity_type
      description: "Type of the entity. See documentation for the full options list."
      required: true
    - name: read_only
      description: "Show read-only events."
      required: false
      type: Boolean
      defaultValue: false
    - name: start_time
      description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: end_time
      description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    outputs:
    - contextPath: Gem.IP.AS_NAME
      description: ""
      type: String
    - contextPath: Gem.IP.AS_NUMBER
      description: ""
      type: String
    - contextPath: Gem.IP.CITY
      description: ""
      type: String
    - contextPath: Gem.IP.COUNTRY_CODE
      description: ""
      type: String
    - contextPath: Gem.IP.COUNTRY_NAME
      description: ""
      type: String
    - contextPath: Gem.IP.COUNT_SOURCEIP
      description: ""
      type: String
    - contextPath: Gem.IP.IP_TYPE
      description: ""
      type: String
    - contextPath: Gem.IP.IS_PRIVATE
      description: ""
      type: String
    - contextPath: Gem.IP.LATITUDE
      description: ""
      type: String
    - contextPath: Gem.IP.LONGITUDE
      description: ""
      type: String
    - contextPath: Gem.IP.PROVIDER
      description: ""
      type: String
    - contextPath: Gem.IP.SOURCEIPADDRESS
      description: ""
      type: String

  - name: gem-list-services-by-entity
    description: List all services accessed by an entity in a specific timeframe. The results are sorted by activity volume.
    arguments:
    - name: entity_id
      description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg."
      required: true
    - name: entity_type
      description: "Type of the entity. See documentation for the full options list."
      required: true
    - name: read_only
      description: "Show read-only events."
      required: false
      type: Boolean
      defaultValue: false
    - name: start_time
      description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: end_time
      description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    outputs:
    - contextPath: Gem.Entity.By.Services.COUNT_SERVICE
      description: ""
      type: String
    - contextPath: Gem.Entity.By.Services.SERVICE
      description: ""
      type: String

  - name: gem-list-events-by-entity
    description: List all events performed by an entity in a specific timeframe. The results are sorted by activity volume.
    arguments:
    - name: entity_id
      description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg."
      required: true
    - name: entity_type
      description: "Type of the entity. See documentation for the full options list."
      required: true
    - name: read_only
      description: "Show read-only events."
      required: false
      type: Boolean
      defaultValue: false
    - name: start_time
      description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: end_time
      description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    outputs:
    - contextPath: Gem.Entity.By.Events.EVENTNAME
      description: ""
      type: String
    - contextPath: Gem.Entity.By.Events.EVENTNAME_COUNT
      description: ""
      type: String

  - name: gem-list-accessing-entities
    description: List all entities that accessed an entity in a specific timeframe. The results are sorted by activity volume.
    arguments:
    - name: entity_id
      description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg."
      required: true
    - name: entity_type
      description: "Type of the entity. See documentation for the full options list."
      required: true
    - name: read_only
      description: "Show read-only events."
      required: false
      type: Boolean
      defaultValue: false
    - name: start_time
      description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: end_time
      description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    outputs:
    - contextPath: Gem.Entity.Accessing.USER_COUNT
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.USER_ID
      description: ""
      type: String

  - name: gem-list-using-entities
    description: List all entities that used an entity in a specific timeframe. The results are sorted by activity volume.
    arguments:
    - name: entity_id
      description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg."
      required: true
    - name: entity_type
      description: "Type of the entity. See documentation for the full options list."
      required: true
    - name: read_only
      description: "Show read-only events."
      required: false
      type: Boolean
      defaultValue: false
    - name: start_time
      description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: end_time
      description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    outputs:
    - contextPath: Gem.Entity.Using.ENTITY_COUNT
      description: ""
      type: String
    - contextPath: Gem.Entity.Using.ENTITY_ID
      description: ""
      type: String

  - name: gem-list-events-on-entity
    description: List all events performed on an entity in a specific timeframe. The results are sorted by activity volume.
    arguments:
    - name: entity_id
      description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg."
      required: true
    - name: entity_type
      description: "Type of the entity. See documentation for the full options list."
      required: true
    - name: read_only
      description: "Show read-only events."
      required: false
      type: Boolean
      defaultValue: false
    - name: start_time
      description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: end_time
      description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    outputs:
    - contextPath: Gem.Entity.On.Events.EVENTNAME
      description: ""
      type: String
    - contextPath: Gem.Entity.On.Events.EVENTNAME_COUNT
      description: ""
      type: String

  - name: gem-list-accessing-ips
    description: List all source IP addresses that accessed an entity in a specific timeframe. The results are sorted by activity volume.
    arguments:
    - name: entity_id
      description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg."
      required: true
    - name: entity_type
      description: "Type of the entity. See documentation for the full options list."
      required: true
    - name: read_only
      description: "Show read-only events."
      required: false
      type: Boolean
      defaultValue: false
    - name: start_time
      description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    - name: end_time
      description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00."
      required: true
    outputs:
    - contextPath: Gem.Entity.Accessing.IPs.AS_NAME
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.AS_NUMBER
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.CITY
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.COUNTRY_CODE
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.COUNTRY_NAME
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.COUNT_SOURCEIP
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.IP_TYPE
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.IS_PRIVATE
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.LATITUDE
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.LONGITUDE
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.PROVIDER
      description: ""
      type: String
    - contextPath: Gem.Entity.Accessing.IPs.SOURCEIPADDRESS
      description: ""
      type: String

  - name: gem-update-threat-status
    description: Set a threat's status to open, in progress or resolved.
    arguments:
    - name: threat_id
      description: The ID of the threat to update.
      required: true
    - name: status
      description: The new status of the threat (open, in_progress, resolved).
      required: true
      auto: PREDEFINED
      predefined:
      - open
      - in_progress
      - resolved
    - name: verdict
      description: The verdict of the threat.
      required: false
      auto: PREDEFINED
      predefined:
      - malicious
      - security_test
      - planned_action
      - not_malicious
      - inconclusive
    - name: reason
      description: The reason for resolving the threat.
      required: false

  - name: gem-run-action
    description: Run an action on an entity.
    arguments:
    - name: action
      description: The action to run.
      required: true
    - name: entity_id
      description: The ID of the entity to run the action on.
      required: true
    - name: entity_type
      description: The type of the entity to run the action on.
      required: true
    - name: alert_id
      description: The ID of the alert to run the action on.
      required: true
    - name: resource_id
      description: The ID of the resource to run the action on.
      required: true

  - name: gem-add-timeline-event
    description: Add a timeline event to a threat.
    arguments:
    - name: threat_id
      description: The ID of the threat to add the timeline event to.
      required: true
    - name: comment
      description: The comment to add to the timeline event.
      required: true

  isfetch: true
  runonce: false
  script: "-"
  type: python
  subtype: python3
  dockerimage: demisto/auth-utils:1.0.0.89650 # TODO: This docker image was selected since it contains the "jwt" package. Double check if it's the correct one.
fromversion: 6.10.0
tests:
- No tests
