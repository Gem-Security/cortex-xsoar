category: Cloud Services
commonfields:
  id: Gem
  version: -1
configuration:
  - defaultvalue: "https://app.gem.security/api/v1"
    display: API Endpoint
    additionalinfo: "The API endpoint to use for connection (US or EU)"
    name: api_endpoint
    type: 15
    required: true
    options:
      - "https://app.gem.security/api/v1"
      - "https://eu-west-1.app.gem.security/api/v1"
  - display: Service Account ID
    additionalinfo: The Service Account ID to use for connection
    name: client_id
    type: 0
    required: true
  - display: Service Account Secret
    additionalinfo: The Service Account Secret to use for connection
    name: client_secret
    type: 4
    required: true
  - display: Sync incidents 30 days back
    name: fetch_back
    type: 8
    required: false
  - display: Use system proxy settings
    name: proxy
    type: 8
    required: false
description: "[Enter a comprehensive, yet concise, description of what the integration does, what use cases it is designed for, etc.]"
display: Gem
name: Gem
script:
  commands:
    - name: gem-list-threats
      description: List all threats detected in Gem
      arguments:
        - name: page
          description: The page number to return.
          required: true
          defaultValue: "1"
        - name: page_size
          description: The number of items to return per page.
          required: true
          defaultValue: "10"
        - name: ordering
          description: The ordering of the items.
          required: false
          defaultValue: "-timeframe_start"
          auto: PREDEFINED
          predefined:
            - "-timeframe_start"
            - "timeframe_state"
            - "-mitre_technique"
            - "mitre_technique"
            - "-severity"
            - "severity"
            - "-assignee"
            - "assignee"
            - "-is_resolved"
            - "is_resolved"
        - name: status
          description: The status of the threats to return.
          required: false
          isArray: true
          auto: PREDEFINED
          predefined:
            - open
            - resolved
            - in_progress
        - name: ttp_id
          description: The TTP ID of the threats to return.
          required: false
        - name: title
          description: The title of the threats to return.
          required: false
        - name: severity
          description: The severity of the threats to return.
          required: false
          isArray: true
          auto: PREDEFINED
          predefined:
            - low
            - medium
            - high
        - name: cloud_provider
          description: The provider of the threats to return.
          required: false
          isArray: true
          auto: PREDEFINED
          predefined:
            - aws
            - azure
            - gcp
            - okta
            - huawei
        - name: entity_type
          description: The entity type of the threats to return.
          required: false
        - name: time_start
          description: "The start time of the threats to return in ISO format. Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: time_end
          description: "The end time of the threats to return in ISO format. Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true

    - name: gem-get-threat-details
      description: Get details about a specific threat
      arguments:
        - name: threat_id
          description: The ID of the threat to get details for.
          required: true

    - name: gem-list-inventory-resources
      description: List inventory resources in Gem
      arguments:
        - name: cursor
          description: The cursor to use for pagination.
          required: false
        - name: page_size
          description: The number of items to return per page.
          required: true
          defaultValue: "10"
        - name: include_deleted
          description: Include deleted resources in the response.
          required: false
          defaultValue: false
          type: Boolean
        - name: region
          description: The region of the resources to return.
          required: false
        - name: resource_type
          description: The type of the resources to return.
          required: false
        - name: search
          description: The search query to use.
          required: false
        - name: total
          description: Whether to include the total count of resources in the response.
          required: false
          defaultValue: false
          type: Boolean

    - name: gem-get-resource-details
      description: Get details about a specific resource
      arguments:
        - name: resource_id
          description: The ID of the resource to get details for.
          required: true

    - name: gem-list-ips-by-entity
      description: List all source IP addresses used by an entity in a specific timeframe. The results are sorted by activity volume.
      arguments:
        - name: entity_id
          description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg"
          required: true
        - name: entity_type
          description: "Type of the entity. See documentation for the full options list."
          required: true
        - name: read_only
          description: "Show read-only events."
          required: false
          type: Boolean
          defaultValue: false
        - name: start_time
          description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: end_time
          description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true

    - name: gem-list-services-by-entity
      description: List all services accessed by an entity in a specific timeframe. The results are sorted by activity volume.
      arguments:
        - name: entity_id
          description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg"
          required: true
        - name: entity_type
          description: "Type of the entity. See documentation for the full options list."
          required: true
        - name: read_only
          description: "Show read-only events."
          required: false
          type: Boolean
          defaultValue: false
        - name: start_time
          description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: end_time
          description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true

    - name: gem-list-events-by-entity
      description: List all events performed by an entity in a specific timeframe. The results are sorted by activity volume.
      arguments:
        - name: entity_id
          description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg"
          required: true
        - name: entity_type
          description: "Type of the entity. See documentation for the full options list."
          required: true
        - name: read_only
          description: "Show read-only events."
          required: false
          type: Boolean
          defaultValue: false
        - name: start_time
          description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: end_time
          description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true

    - name: gem-list-accessing-entities
      description: List all entities that accessed an entity in a specific timeframe. The results are sorted by activity volume.
      arguments:
        - name: resource_id
          description: "Gem ID of the resource. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg"
          required: true
        - name: resource_type
          description: "Type of the resource. See documentation for the full options list."
          required: true
        - name: read_only
          description: "Show read-only events."
          required: false
          type: Boolean
          defaultValue: false
        - name: start_time
          description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: end_time
          description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true

    - name: gem-list-using-entities
      description: List all entities that used an entity in a specific timeframe. The results are sorted by activity volume.
      arguments:
        - name: resource_id
          description: "Gem ID of the resource. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg"
          required: true
        - name: resource_type
          description: "Type of the resource. See documentation for the full options list."
          required: true
        - name: read_only
          description: "Show read-only events."
          required: false
          type: Boolean
          defaultValue: false
        - name: start_time
          description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: end_time
          description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true

    - name: gem-list-events-on-entity
      description: List all events performed on an entity in a specific timeframe. The results are sorted by activity volume.
      arguments:
        - name: entity_id
          description: "Gem ID of the entity. This will usually be the ARN or CSP ID. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg"
          required: true
        - name: entity_type
          description: "Type of the entity. See documentation for the full options list."
          required: true
        - name: read_only
          description: "Show read-only events."
          required: false
          type: Boolean
          defaultValue: false
        - name: start_time
          description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: end_time
          description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
    - name: gem-list-accessing-ips
      description: List all source IP addresses that accessed an entity in a specific timeframe. The results are sorted by activity volume.
      arguments:
        - name: resource_id
          description: "Gem ID of the resource. This property is also available for every resource in the Inventory screen. Example: arn:aws:ec2:us-east-1:112233445566:instance/i-1234567890abcdefg"
          required: true
        - name: resource_type
          description: "Type of the resource. See documentation for the full options list."
          required: true
        - name: read_only
          description: "Show read-only events."
          required: false
          type: Boolean
          defaultValue: false
        - name: start_time
          description: "Timeframe start (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true
        - name: end_time
          description: "Timeframe end (ISO format). Examples: 2023-01-01, 2023-01-01T01:01:01Z, 2023-01-01T01:01:01+00:00"
          required: true

    - name: gem-update-threat-status
      description: Set a threat's status to open, in progress or resolved.
      arguments:
        - name: threat_id
          description: The ID of the threat to update.
          required: true
        - name: status
          description: The new status of the threat (open, in_progress, resolved).
          required: true
          auto: PREDEFINED
          predefined:
            - open
            - in_progress
            - resolved
        - name: verdict
          description: The verdict of the threat.
          required: true
          auto: PREDEFINED
          predefined:
            - malicious
            - security_test
            - planned_action
            - not_malicious
            - inconclusive
        - name: reason
          description: The reason for resolving the threat.
          required: false

  runonce: false
  script: "-"
  type: python
  subtype: python3
  dockerimage: demisto/auth-utils:1.0.0.76157 # TODO: This docker image was selected since it contains the "jwt" package. Double check if it's the correct one.
fromversion: 5.5.0
tests:
  - No tests
